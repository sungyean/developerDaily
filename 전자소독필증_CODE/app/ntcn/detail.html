<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>팝업</title>
	<link rel="stylesheet" href="../assets/css/common.css">
	<link rel="stylesheet" href="../assets/css/style.css">
	<script type="text/javascript" src="../assets/js/jquery-3.4.1.min.js"></script>
	<script type="text/javascript" src="../assets/js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../assets/js/custom.js"></script>
	<script type="text/javascript" src="../../assets/js/comm.js"></script>
	<script type="text/javascript" src="../../assets/js/searchModal.js"></script>
	<!-- sessionChk -->
	<script type="text/javascript" src="../../assets/js/sessionChk.js"></script>
	<script type="text/javascript">
		var loginUserId = getSigninAccount().accountId;
		let id = getParameter("id");

		$(document).ready(function() {
			sessionChk();
			var newDiv = document.createElement("div");
			var modal = "<div class='popup-wrap delete sm' id='comditionModal'>";
				modal += "<div class='popup-box sm'>";
				modal += "	<!-- header -->";
				modal += "<header class='user2'>";
				modal += "    <div class='title-box'>";
				modal += "         <h1>팝업</h1>";
				modal += "    </div>";
				/* modal += "<a href='#' class='btn-popup-close'><img src='../assets/images/btn-popup-close.png' alt='팝업닫기'></a>" */
				modal += "</header>";
				modal += "<!-- //header -->";
				modal += "<div class='container'>";
				modal += "<div class='container-text'>";
				modal += "   <div class='condition-box' id='ntcnMssageCn'></div>";
				modal += "       <button class='btn-condition-left' id='btn-left' onclick='searchConditionFunction()'>조회</button>";
				modal += "       <button class='btn-condition-right' id='btn-right' onclick='searchConditionFunction()'>조회</button>";
				modal += "   </div>";
				modal += "</div>";
				modal += "</div>";
				modal += "</div>";

			newDiv.innerHTML=modal;
			document.body.append(newDiv);
			
			$('.popup-wrap.delete').fadeIn();
			// popup close
			$('.btn-popup-close').on('click',function(e){
				e.preventDefault();
				//$(this).parent().parent().parent('.popup-wrap').hide();
				$('.popup-wrap.delete').hide();
				$('.popup-wrap.delete').parent().remove();
			});


			$.ajax({
				type: 'GET',
				url: global.apiUrl+"/ntcnMssages/"+id,
				async: false,
				contentType: "application/json",
				dataType: 'json',
				success: function (res) {
					document.getElementById('ntcnMssageCn').innerText=res.ntcnMssageCn;
					document.getElementById('btn-left').innerText=res.actions[0].buttonValue;
					document.getElementById('btn-left').onclick = function(){
						if(res.actions[0].apiUrl) {
							$.ajax({
								type: res.actions[0].apiMethod,
								url: global.apiUrl+res.actions[0].apiUrl,
								async: false,
								contentType: "application/json",
								dataType: 'json',
								data: res.actions[0].apiBody,
								success: function (res1) {
									alert("정상적으로 처리되었습니다.")
								}, 
								complete: function (res1) {
									window.location.href=global.htmlUrl+res.actions[0].targetUrl;
								},
								error: function(err) {
									alert("실패");
								}
							});
						} else {
							window.location.href=global.htmlUrl+res.actions[0].targetUrl;
						}
					}
					document.getElementById('btn-right').innerText=res.actions[1].buttonValue;
					document.getElementById('btn-right').onclick = function(){
						if(res.actions[1].apiUrl) {
							$.ajax({
								type: res.actions[1].apiMethod,
								url: global.apiUrl+res.actions[1].apiUrl,
								async: false,
								contentType: "application/json",
								dataType: 'json',
								data: res.actions[1].apiBody,
								success: function (res2) {
									console.log(res2)
									alert(res2)
									
								}, 
								complete: function (res2) {
									window.location.href=global.htmlUrl+res.actions[1].targetUrl;
								},
								error: function(err) {
									alert("실패");
								}
							});
						} else {
							window.location.href=global.htmlUrl+res.actions[1].targetUrl;
						}
					}
				}, 
				complete: function (res) {
					
				},
				error: function(err) {
					alert("실패");
				}
			});
		})



	</script>
</head>
<body>
	
</body>