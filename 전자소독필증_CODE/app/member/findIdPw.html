<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>아이디/비밀번호 찾기</title>
	<link rel="stylesheet" href="../assets/css/common.css">
	<link rel="stylesheet" href="../assets/css/style.css">
	<script type="text/javascript" src="../assets/js/jquery-3.4.1.min.js"></script>
	<script type="text/javascript" src="../assets/js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../assets/js/custom.js"></script>
	<script type="text/javascript" src="../../assets/js/comm.js"></script>
	<script type="text/javascript" src="../../assets/js/conditionModal.js"></script>
	<!-- Data format-->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
	<!-- sessionChk -->
    <script type="text/javascript" src="../../assets/js/sessionChk.js"></script>
    <!-- 공통 모달 -->
    <script type="text/javascript" src="../../assets/js/confirmModal.js"></script>
    
	<script type="text/javascript">
		$(document).ready(function() {
        })
        //로그인 화면 이동.
        function loginMove(){
            location.href="./login.html";
        }
        //아이디 찾기 function.
        function idFindFunction(){
            event.preventDefault();
            if($("#userType").val() == ""){
                makeModalAlert("회원 선택은 필수 입력값 입니다.")
                return false;
            }
            if($("#moblphon").val() == ""){
                makeModalAlert("휴대폰 번호는 필수 입력값 입니다.")
                return false;
            }
            if (!/(0[0-9]{1}[0-9]{1})([0-9]{3,4})([0-9]{4})$/.test($('#moblphon').val())){
				makeModalAlert("다음과 같은 형식으로만 작성해 주세요.<br> ex) 01012345678 ");
				return false;
			}
            $.ajax({
				type: 'GET',
				url: global.apiUrl + "/members/findUserId?accountTy="+ $("#userType").val()+"&moblphon="+$("#moblphon").val(),
				async: false,
				//data: JSON.stringify(form),
				//contentType: "application/json",
				//dataType: 'json',
				success: function (res) {
                    console.log("res",res)
                    modalAlert(res+"이메일로 아이디가 발송 되었습니다.");
				},
				error: function (err) {
					console.log("err", err)
                    modalAlert("등록된 휴대폰 번호가 없습니다.");
                    return false;
                },
			});
        }
        //login 화면으로 이동.
        function modalAlert_close(){
            window.location.href="./login.html"
        }
        //비밀번호 찾기 function.
        function pwFindFunction(){
            event.preventDefault();
            if($("#userType2").val() == ""){
                makeModalAlert("회원 선택은 필수 입력값 입니다.")
                return false;
            }
            if($("#accountId2").val() == ""){
                makeModalAlert("아이디는 필수 입력값 입니다.")
                return false;
            }
            $.ajax({
				type: 'GET',
				url: global.apiUrl + "/members/findUserPw?accountTy="+ $("#userType2").val()+"&accountId="+$("#accountId2").val(),
				async: false,
				success: function (res) {
                    console.log("res",res)
                    modalAlert(res+"이메일로 임시비밀번호가 발송 되었습니다.");
				},
				error: function (err) {
					console.log("err", err)
                    modalAlert("등록된 아이디가 없습니다.");
                    return false;
                },
			});
        }

        function makeModalAlert(title) {
            var newDiv = document.createElement("div"); 
            var modal = "<div class='popup-wrap delete sm' id='search_modal_alert'>";
                modal += "<div class='popup-box sm'>";
                modal += "<div class='popup-header sm'>"
                modal += "<a href='#' class='btn-popup-close'><img src='../assets/images/btn-popup-close.png' alt='팝업닫기'></a>"
                modal += "</div>"
                modal += "<div class='popup-contents sm'>"
                modal += "<p class='txt'>"+title+"</p>"
                modal += "</div>"
                modal += "<div class='popup-footer sm'>"
                modal += "<button type='button' class='btn bg-green btn-delete' style='width:100%;' onclick='makeModalAlertClose();'>확인</button>"
                modal += "</div>"
                modal += "</div>";
                modal += "</div>";
                newDiv.innerHTML=modal;
                document.body.append(newDiv);

                $('#search_modal_alert').fadeIn();
                // popup close
                $('.btn-popup-close').on('click',function(e){
                    e.preventDefault();
                    //$(this).parent().parent().parent('.popup-wrap').hide();
                    $('#search_modal_alert').hide();
                    $('#search_modal_alert').parent().remove();
                });
		    return modal;
        }
        function makeModalAlertClose(){
            event.preventDefault();
            $('#search_modal_alert').hide();
        }
        
		
	</script>
</head>
<body>
	<div class="mylist user1 bg-gray" id="wrap">
		<!-- header -->
		<header class="user1">
			<div class="title-box">
				<button class="btn-back" onclick="pageBack();">
					<img src="../assets/images/btn-back.png" alt="back">
				</button>
				<h1>아이디/비밀번호 찾기</h1>
			</div>
		</header>
		<div class="mylist-tab-menu">
			<ul>
				<li class="on"><a href="#box1">아이디 찾기</a></li>
				<li><a href="#box2">비밀번호 찾기</a></li>
			</ul>
		</div>
		<div class="container">      
        <!-- <div class="container pd-yes"> -->
            <!-- 아이디 찾기 -->
            <form>
                <div id="box1" class="mylist-wrap user1">
                    <div class="input-box sm">
                        <label for="">회원선택 <b class="point">*</b></label>
                        <select id="userType" name="userType" class="">
                            <option value="">사용자 유형</option>
                            <option value="STKRS_VHCLE_DRVER">축산차량 운전자</option>
                            <option value="POSITN_DSNF_FCLTY_MNGR">거점소독시설 관리자</option>
                            <option value="STKRS_FCLTY_CHARGER">시설 관리자</option>
                        </select>
                    </div>
                    <div class="input-box sm">
                        <label for="name">휴대폰 번호 <b class="point">*</b></label>
                        <input type="text" name="moblphon" id="moblphon" placeholder="숫자만 입력해 주세요">
                    </div>
                    <div class="btn-wrap double">
                        <button type="button" class="btn border-green lg btn-join"onclick="loginMove();">취소</button>
                        <button type="submit" class="btn bg-green lg btn-join" onclick="idFindFunction();">아이디 찾기</button>
                    </div>
                </div>
            </form>
            <!-- 비밀번호 칮기 -->
            <form>
                <div id="box2" class="mylist-wrap user1">
                    <div class="input-box sm">
                        <label for="">회원선택 <b class="point">*</b></label>
                        <select id="userType2" name="userType2" class="">
                            <option value="">사용자 유형</option>
                            <option value="STKRS_VHCLE_DRVER">축산차량 운전자</option>
                            <option value="POSITN_DSNF_FCLTY_MNGR">거점소독시설 관리자</option>
                            <option value="STKRS_FCLTY_CHARGER">시설 관리자</option>
                        </select>
                    </div>
                    <div class="input-box sm">
                        <label for="accountId2">아이디 <b class="point">*</b></label>
                        <input type="text" name="accountId2" id="accountId2" placeholder="아이디">
                    </div>
                    <div class="btn-wrap double">
                        <button type="button" class="btn border-green lg btn-join"onclick="loginMove();">취소</button>
                        <button type="submit" class="btn bg-green lg btn-join" onclick="pwFindFunction();">비밀번호 찾기</button>
                    </div>
                </div>
            </form>
		</div>
	</div>
</body>
</html>
	